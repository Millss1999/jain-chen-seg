function pD = pD(di, c, max)
  pD = c*(1-(di/max));
